## 容器镜像仓库（Harbor）

1. 将 CA 证书 ca.crt 导入到本地虚拟机的 Docker 中，重启 docker

```shell
# mkdir -p /etc/docker/certs.d/goharbor.com
# cp /vagrant_data/ca.crt /etc/docker/certs.d/goharbor.com
# systemcrl restart docker
```

2. 配置 DNS 解析

由于我们是本地虚拟机，而且虚拟机 DNS 已经指向自己电脑，只需要配置自己电脑的 hosts

```shell
# vim /etc/hosts

192.168.110.72 goharbor.com

# ping goharbor.com
PING goharbor.com (192.168.110.72): 56 data bytes
64 bytes from 192.168.110.72: icmp_seq=0 ttl=62 time=10.752 ms
64 bytes from 192.168.110.72: icmp_seq=1 ttl=62 time=19.315 ms
64 bytes from 192.168.110.72: icmp_seq=2 ttl=62 time=10.964 ms
```

在虚拟机中 ping goharbor.com

```shell
# ping goharbor.com
PING goharbor.com (192.168.110.72) 56(84) bytes of data.
64 bytes from goharbor.com (192.168.110.72): icmp_seq=1 ttl=63 time=12.4 ms
64 bytes from goharbor.com (192.168.110.72): icmp_seq=2 ttl=63 time=15.4 ms
```

3. Docker login

```shell
# docker login goharbor.com
Username: admin
Password:
WARNING! Your password will be stored unencrypted in /root/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded

```

[509: certificate signed by unknown authority](https://gitee.com/zheng11581/cloudnative/blob/main/kubernetes/demo/Harbor/installation/self-signed-ca.MD)

4. 推送镜像到镜像仓库

```shell
# docker tag discovery-service:latest goharbor.com/demo/discovery-service:latest

# docker push goharbor.com/demo/discovery-service:latest
```
